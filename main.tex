\documentclass[dvipsnames]{beamer}
\beamertemplatenavigationsymbolsempty
\usetheme{Boadilla}
\usefonttheme[onlymath]{serif}

\usepackage{amsmath}
\usepackage{bm}
\usepackage{bbm}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage[cal=boondoxo]{mathalpha}

% Change horizontal spacing
\setlength{\tabcolsep}{3pt}

\usepackage[none]{hyphenat} % no hyphenation

\usepackage{array}

\usepackage{cancel}

\usepackage[style=authoryear,maxcitenames=2,backend=biber,citetracker=true]{biblatex}
\addbibresource{references.bib}

\usepackage{verbatim}

\newcommand{\credit}[2]{\par\hfill \footnotesize #1 credit:~\itshape\citeauthor{#2} (\citeyear{#2})}
\renewcommand{\cite}[1]{(\citeauthor{#1}, \citeyear{#1})}
\newcommand{\citefoot}[1]{\citeauthor{#1} (\citeyear{#1})}
\newcommand{\matr}[1]{#1}

\newcommand{\red}[1]{{\color{red} #1}}

\title[XAI with Shapley Value]
{Explainable Machine Learning\\with Shapley Value}
%\subtitle{}
\author{Gianmarco Midena}
\institute{Aalto University}
\date{12 March 2024}

\begin{document}
\begin{frame}
\titlepage
\end{frame}

%\begin{frame}{Outline}
%\tableofcontents
%\end{frame}

\input{sections/attribution_problem.tex}

\begin{frame}{Example - Probability of Cervical Cancer for a Woman}
	\begin{center}
		\includegraphics[scale=0.6]{images/shapley-cervical-plot-1.jpeg}
	\end{center}
\credit{Image}{molnar2020interpretable}
\end{frame}

\begin{frame}{Risk Factors for Cervical Cancer\footnotemark}
\begin{itemize}
	\item Has patient ever had a sexually transmitted disease (STD) [binary]
	\item Number of sexual partners
	\item Number of STD diagnoses
	\item Number of pregnancies
	\item First sexual intercourse (age in years)
	\item Hormonal contraceptives (in years)
	\item Age in years
	\item Hormonal contraceptives [binary]
	\item Smokes (binary)
	\item Number of years with an intrauterine device (IUD)
	\item Intrauterine device (IUD) [binary]
	\item Time since first STD diagnosis
	\item Time since last STD diagnosis
	\item Smokes (in years)
\end{itemize}
\footnotetext[2]{\citeauthor{risk_factors_dataset} (\citeyear{risk_factors_dataset})}
\end{frame}

\begin{frame}{Example - Number of Rented Bikes for a Day}
	\begin{center}
		\includegraphics[scale=0.6]{images/shapley-bike-plot-1.jpeg}
	\end{center}
	\credit{Image}{molnar2020interpretable}
\end{frame}

\begin{frame}{Bike Rental Features\footnotemark}
	\begin{itemize}
		\item Temperature in degrees Celsius
		\item Season: spring, summer, fall or winter
		\item Working day or weekend
		\item Holiday or not
		\item Wind speed in km per hour
		\item Year: 2011 or 2012
		\item Nr. days since 01.01.2011 (the first day in the dataset).
		\item Weather situation:
		\begin{enumerate}[a]
			\item clear, few clouds, partly cloudy, cloudy
			\item mist + clouds, mist + broken clouds, mist + few clouds, mist
			\item light snow, light rain + thunderstorm + scattered clouds, light rain + scattered clouds
			\item heavy rain + ice pallets + thunderstorm + mist, snow + mist
		\end{enumerate}
		\item Relative humidity percentage
	\end{itemize}
	\footnotetext[3]{\citeauthor{bike_sharing_dataset} (\citeyear{bike_sharing_dataset})}
\end{frame}

\input{sections/linear_model_feature_contribution.tex}

\begin{frame}{Feature Contribution in General}
	\begin{itemize}
		\item \emph{Can we do the same for any type of model?}
		\begin{itemize}
			\item Model-agnostic
			\item No assumptions on features interactions
		\end{itemize}
		\item \red{Nonlinear models need a different solution!}
		\item Possible solution: \underline{Shapley value}
		\begin{itemize}
			\item Field: cooperative game theory
		\end{itemize}
	\end{itemize}
\end{frame}

\input{sections/shapley_value.tex}

\input{sections/shapley_value_issues.tex}

\begin{frame}[fragile]{Software}
	\begin{itemize}
		\item \verb|fastshap| (R)~\cite{jethani2021fastshap}
		\item \verb|iml| (R)~\cite{molnar2018iml}
		\item \verb|breakDown| (R)~\cite{staniak2018explanations}
		\item \verb|Shapley.jl| (Julia)~\footnotemark
		\item \dots
	\end{itemize}
	\footnotetext[5]{\href{https://gitlab.com/ExpandingMan/Shapley.jl}{https://gitlab.com/ExpandingMan/Shapley.jl}}
\end{frame}

\begin{frame}{Shapley Value in Short}
	\begin{itemize}
		\item Permutation-based
		\item Model-agnostic
		\item Solid theory
		\item Full-explanation
		\begin{itemize}
			\item All the features
			\item Non sparse (proper subset of features)
		\end{itemize}
		\item Model-free
		\item Data access or generation
		\item Building block in SHAP~\cite{lundberg2017unified}
	\end{itemize}
\end{frame}

\section{References}
\begin{frame}[allowframebreaks]
\frametitle{References}
\printbibliography
\end{frame}

\end{document}